#!/bin/bash\n\n# ========================================= #\n# SAMA CONAI - LANCEMENT VERSION ODOO RÃ‰ELLE #\n# ========================================= #\n\necho \"ðŸ‡¸ðŸ‡³ SAMA CONAI - Version Odoo RÃ©elle\"\necho \"====================================\"\necho \"\"\n\n# Couleurs\nGREEN='\\033[0;32m'\nBLUE='\\033[0;34m'\nYELLOW='\\033[1;33m'\nRED='\\033[0;31m'\nPURPLE='\\033[0;35m'\nCYAN='\\033[0;36m'\nNC='\\033[0m'\n\nprint_step() {\n    echo -e \"${BLUE}âž¤${NC} $1\"\n}\n\nprint_success() {\n    echo -e \"${GREEN}âœ…${NC} $1\"\n}\n\nprint_warning() {\n    echo -e \"${YELLOW}âš ï¸${NC} $1\"\n}\n\nprint_error() {\n    echo -e \"${RED}âŒ${NC} $1\"\n}\n\nprint_info() {\n    echo -e \"${CYAN}â„¹ï¸${NC} $1\"\n}\n\n# Variables\nPORT=3008\nSERVER_FILE=\"mobile_app_web/server_odoo_real.js\"\nPID_FILE=\"pids/sama_conai_odoo_real.pid\"\nLOG_FILE=\"logs/sama_conai_odoo_real_$(date +%Y%m%d_%H%M%S).log\"\n\n# VÃ©rification des prÃ©requis\nprint_step \"VÃ©rification des prÃ©requis...\"\n\nif [ ! -f \"$SERVER_FILE\" ]; then\n    print_error \"Serveur Odoo rÃ©el non trouvÃ©: $SERVER_FILE\"\n    exit 1\nfi\n\nif [ ! -f \"mobile_app_web/public/sama_conai_odoo_real.html\" ]; then\n    print_error \"Interface Odoo rÃ©elle non trouvÃ©e\"\n    exit 1\nfi\n\nif [ ! -f \"mobile_app_web/odoo_connector.js\" ]; then\n    print_error \"Connecteur Odoo non trouvÃ©\"\n    exit 1\nfi\n\nprint_success \"Fichiers Odoo rÃ©els prÃ©sents\"\n\n# VÃ©rification Node.js\nif ! command -v node &> /dev/null; then\n    print_error \"Node.js n'est pas installÃ©\"\n    exit 1\nfi\n\nprint_success \"Node.js disponible\"\n\n# VÃ©rification des dÃ©pendances\nprint_step \"VÃ©rification des dÃ©pendances...\"\ncd mobile_app_web\n\nif [ ! -d \"node_modules\" ]; then\n    print_warning \"Installation des dÃ©pendances...\"\n    npm install\nfi\n\n# VÃ©rification xmlrpc\nif ! npm list xmlrpc &> /dev/null; then\n    print_warning \"Installation xmlrpc...\"\n    npm install xmlrpc\nfi\n\nprint_success \"DÃ©pendances vÃ©rifiÃ©es\"\ncd ..\n\n# VÃ©rification de la connexion Odoo\nprint_step \"VÃ©rification de la connexion Odoo...\"\nODOO_URL=\"http://localhost:8077\"\nif curl -s --connect-timeout 5 \"$ODOO_URL\" > /dev/null; then\n    print_success \"Odoo accessible sur le port 8077\"\nelse\n    print_warning \"Odoo non accessible - Mode fallback sera utilisÃ©\"\nfi\n\n# CrÃ©ation des rÃ©pertoires\nmkdir -p pids\nmkdir -p logs\n\n# Nettoyage des processus existants\nprint_step \"Nettoyage des processus existants...\"\nif [ -f \"$PID_FILE\" ]; then\n    OLD_PID=$(cat \"$PID_FILE\")\n    if ps -p $OLD_PID > /dev/null 2>&1; then\n        kill $OLD_PID\n        sleep 2\n    fi\n    rm -f \"$PID_FILE\"\nfi\n\n# Nettoyage par port\npkill -f \"server_odoo_real.js\" 2>/dev/null || true\nsleep 1\n\nprint_success \"Processus nettoyÃ©s\"\n\n# DÃ©marrage du serveur Odoo rÃ©el\nprint_step \"DÃ©marrage du serveur SAMA CONAI Odoo rÃ©el...\"\ncd mobile_app_web\nnohup node server_odoo_real.js > \"../$LOG_FILE\" 2>&1 &\nSERVER_PID=$!\necho $SERVER_PID > \"../$PID_FILE\"\ncd ..\n\nsleep 3\n\n# VÃ©rification du dÃ©marrage\nif ps -p $SERVER_PID > /dev/null 2>&1; then\n    print_success \"Serveur Odoo rÃ©el dÃ©marrÃ© (PID: $SERVER_PID)\"\nelse\n    print_error \"Ã‰chec du dÃ©marrage du serveur\"\n    exit 1\nfi\n\n# Test de connectivitÃ©\nprint_step \"Test de connectivitÃ©...\"\nsleep 2\n\nif curl -s \"http://localhost:$PORT\" > /dev/null; then\n    print_success \"Interface Odoo rÃ©elle accessible\"\nelse\n    print_error \"Interface non accessible\"\n    exit 1\nfi\n\n# Test API Odoo\nprint_step \"Test API Odoo...\"\nODOO_TEST_RESULT=$(curl -s \"http://localhost:$PORT/api/odoo/test\" | grep -o '\"success\":[^,]*' || echo '\"success\":false')\nif echo \"$ODOO_TEST_RESULT\" | grep -q '\"success\":true'; then\n    print_success \"Connexion Odoo fonctionnelle\"\nelse\n    print_warning \"Connexion Odoo Ã©chouÃ©e - Mode fallback actif\"\nfi\n\necho \"\"\necho -e \"${PURPLE}ðŸŽ‰ SAMA CONAI Version Odoo RÃ©elle LancÃ©e !${NC}\"\necho \"===========================================\"\necho \"\"\n\necho -e \"${CYAN}ðŸ”— AccÃ¨s Ã  la version Odoo rÃ©elle :${NC}\"\necho \"   http://localhost:$PORT/\"\necho \"\"\n\necho -e \"${CYAN}ðŸ”§ Comparaison avec version simulÃ©e :${NC}\"\necho \"   http://localhost:3007/enriched (DonnÃ©es simulÃ©es)\"\necho \"   http://localhost:$PORT/ (DonnÃ©es Odoo rÃ©elles)\"\necho \"\"\n\necho -e \"${CYAN}ðŸ“Š APIs spÃ©cifiques :${NC}\"\necho \"   http://localhost:$PORT/api/odoo/test (Test connexion)\"\necho \"   http://localhost:$PORT/api/mobile/level1/dashboard (Dashboard)\"\necho \"   http://localhost:$PORT/api/mobile/level2/requests (Demandes)\"\necho \"   http://localhost:$PORT/api/mobile/level2/alerts (Alertes)\"\necho \"\"\n\necho -e \"${CYAN}ðŸ”— Backend Odoo :${NC}\"\necho \"   http://localhost:8077\"\necho \"\"\n\necho -e \"${CYAN}ðŸ‘¤ Connexion :${NC}\"\necho \"   Utilisateur: admin\"\necho \"   Mot de passe: admin\"\necho \"\"\n\necho -e \"${CYAN}âœ¨ DÃ©veloppement progressif :${NC}\"\necho \"   âœ… Phase 1: Dashboard avec donnÃ©es Odoo rÃ©elles\"\necho \"   âœ… Phase 2: Listes avec donnÃ©es Odoo (si disponibles)\"\necho \"   ðŸš§ Phase 3: DÃ©tails complets (en dÃ©veloppement)\"\necho \"\"\n\necho -e \"${CYAN}ðŸ“Š Indicateurs de source :${NC}\"\necho \"   ðŸŸ¢ Odoo: DonnÃ©es rÃ©elles d'Odoo\"\necho \"   ðŸŸ¡ Fallback: DonnÃ©es simulÃ©es (si Odoo indisponible)\"\necho \"   ðŸ”µ Development: FonctionnalitÃ© en dÃ©veloppement\"\necho \"\"\n\necho -e \"${CYAN}ðŸ›‘ Pour arrÃªter :${NC}\"\necho \"   ./stop_odoo_real_sama_conai.sh\"\necho \"\"\n\necho -e \"${CYAN}ðŸ“Š Logs en temps rÃ©el :${NC}\"\necho \"   tail -f $LOG_FILE\"\necho \"\"\n\n# Ouverture automatique du navigateur\nprint_step \"Ouverture du navigateur...\"\nif command -v xdg-open > /dev/null; then\n    xdg-open \"http://localhost:$PORT\" &\nelif command -v open > /dev/null; then\n    open \"http://localhost:$PORT\" &\nfi\n\nprint_success \"SAMA CONAI Version Odoo RÃ©elle est prÃªt Ã  l'utilisation !\"\n\necho \"\"\necho \"===========================================\"\necho \"ðŸ‡¸ðŸ‡³ SAMA CONAI - Version Odoo RÃ©elle Active\"\necho \"===========================================\"